# Reference: <https://postmarketos.org/devicepkg>
pkgname="device-samsung-p4wifi"
pkgdesc="Galaxy Tab 10.1"
pkgver=0.1
pkgrel=7
url="https://postmarketos.org"
license="MIT"
arch="noarch"
options="!check"
depends="postmarketos-base linux-samsung-p4wifi mkbootimg
	mesa-grate mesa-grate-glapi mesa-grate-gl mesa-grate-gbm mesa-grate-egl
	mesa-grate-dri-tegra libdrm-grate xf86-video-opentegra
	alsa-utils"
makedepends="devicepkg-dev"
subpackages="$pkgname-nonfree-firmware:nonfree_firmware"
source="deviceinfo
	modules-load.conf
	modprobe.conf
	90-device-samsung-p4wifi-audio.rules
	90-device-samsung-p4wifi-jack.rules
	HiFi
	wm8994aif1.conf
	HiFi-P4WIFI
	P4WIFI.conf
	90-device-samsung-p4wifi-twofing.rules"

build() {
	devicepkg_build $startdir $pkgname
}

package() {
	devicepkg_package $startdir $pkgname

	install -D -m644 "$srcdir"/modules-load.conf \
		"$pkgdir"/etc/modules-load.d/00-${pkgname}.conf
	install -D -m644 "$srcdir"/modprobe.conf \
		"$pkgdir"/etc/modprobe.d/00-${pkgname}.conf

	install -D -m644 "$srcdir"/HiFi \
		"$pkgdir"/usr/share/alsa/ucm/wm8994aif1/HiFi
	install -D -m644 "$srcdir"/wm8994aif1.conf \
		"$pkgdir"/usr/share/alsa/ucm/wm8994aif1/wm8994aif1.conf
	install -D -m644 "$srcdir"/HiFi-P4WIFI \
		"$pkgdir"/usr/share/alsa/ucm/P4WIFI/HiFi
	install -D -m644 "$srcdir"/P4WIFI.conf \
		"$pkgdir"/usr/share/alsa/ucm/P4WIFI/P4WIFI.conf
	install -D -m644 "$srcdir"/90-device-samsung-p4wifi-audio.rules \
		"$pkgdir"/etc/udev/rules.d/90-device-samsung-p4wifi-audio.rules
	install -D -m644 "$srcdir"/90-device-samsung-p4wifi-jack.rules \
		"$pkgdir"/etc/udev/rules.d/90-device-samsung-p4wifi-jack.rules

	install -D -m644 "$srcdir"/90-device-samsung-p4wifi-twofing.rules \
		"$pkgdir"/etc/udev/rules.d/90-device-samsung-p4wifi-twofing.rules
}

nonfree_firmware() {
	pkgdesc="bcm4330 wifi firmware"
	depends="firmware-samsung-p4wifi"
	mkdir "$subpkgdir"
}

sha512sums="e0f27fb7b8daf0a61ced8739d3760ca8ecda4206e526c2b8d693e573d1e4a2371e69cc3af4d012134de5df021f13d93bc549430ee0c0277679a7a2f5944a9c24  deviceinfo
d8ce60ea7acaabf627ddca2f0887a4cda46f313b7aaf7934bef2fef8a6e0798ccefab849e4571e4e3fcd06ae34c1a6efe3b58b401e2e443416f6200e6d4ea769  modules-load.conf
56b865bab0714aed53bd6535ebefd2f3629ec78786e8f87dcae4637cfacb5912d28dc39d1fe0287d34bb36b4a8371481f54647e1b25190afbcd23ed30fe7edac  modprobe.conf
484d45274d55e383fcb495c81d0e8e4415f052ae7265bd9e61b1fa4fc59163e5d73c96e65816fdc96bf5050f05cc9558e557f584ba23174dc0db5c5e9d861c83  90-device-samsung-p4wifi-audio.rules
46aab5ce9a170e743390640fee259af51facdfa9e04c9b24842b40589bd5b25d194dfd0d166e27ac4129889e03913abb72e5468835203a606dd99017876c8204  90-device-samsung-p4wifi-jack.rules
a62bbae27b3e76e5ba4b3d06fdd3a35e14b69319b213724196b5ab8acf2086bdf6aef3feef20b262294860f03b8b202a094702af458fe1cfff74c5a17a1cd915  HiFi
16640080221d6ce6b87eb02bef401a18152008f75e52c0db2eee0a67f1ac65fc9ed053cc2388012f3f661e8f5526e8133af4ae2a5176441fde382597c02a75fa  wm8994aif1.conf
c30e0ac7bd5def5604bf8aef9c722d8540a30f64bb14a5d94bdde541ad88c450fe067682259e106a428385ecbfab9ae68ed8357cebbb3dbbb28cd52ed97e1d76  HiFi-P4WIFI
dbac778296ab5540f7a69b71a17faf8894d8fb2fe3676403a2c5825aa75beab220b106e066e23237be6c87739f4839cc9c8fbae2cfb2471decdc2642bd78904f  P4WIFI.conf"
